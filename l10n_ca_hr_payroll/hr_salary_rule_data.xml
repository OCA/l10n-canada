<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data noupdate="1">      

    <!-- Salary Rules Category -->

        <record id="I" model="hr.salary.rule.category">
            <field name="name">Taxable Income</field>
            <field name="code">I</field>
        </record>

        <record id="CALC" model="hr.salary.rule.category">
            <field name="code">CALC</field>
            <field name="name">Standard Calculation</field>
        </record>

        <record id="FCALC" model="hr.salary.rule.category">
            <field name="code">FCALC</field>
            <field name="name">Federal Calculation</field>
        </record>

        <record id="PCALC" model="hr.salary.rule.category">
            <field name="code">PCALC</field>
            <field name="name">Provincial Calculation</field>
        </record>

        <record id="EMP" model="hr.salary.rule.category">
            <field name="code">EMP</field>
            <field name="name">Employer Contribution</field>
        </record>

        <record id="SDED" model="hr.salary.rule.category">
            <field name="code">SDED</field>
            <field name="name">Source Deduction</field>
            <field name="note">Used for after tax deductions at source</field>
        </record>

        <record id="VAC" model="hr.salary.rule.category">
            <field name="code">VAC</field>
            <field name="name">Vacation Calculation</field>
        </record> 

    <!-- Common rules to all canadian salary structures -->

        <record id="rule_ca_p" model="hr.salary.rule">
            <field name="name">Pays Per Year</field>
            <field name="sequence" eval="1"/>
            <field name="code">P</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="CALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.pays_per_year or 0</field>
            <field name="note">Pays per year from the contract form</field>
        </record>
pcalc
        <record id="rule_ca_pocc" model="hr.salary.rule">
            <field name="name">Payslip Counter (POCC)</field>
            <field name="sequence" eval="1"/>
            <field name="code">POCC</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="CALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">fix</field>
            <field name="quantity">1.0</field>
            <field name="amount_fix">1.0</field>
            <field name="note">Sloppy way of counting payslips for use in PR calc</field>
        </record>

        <record id="rule_ca_basic" model="hr.salary.rule">
            <field name="name">Basic per pay (BASICP)</field>
            <field name="sequence" eval="10"/>
            <field name="code">BASICP</field>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="CALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = BASIC / P</field>
        </record>

    <!-- Employment insurance - Employee - 140 -->
          
        <record id="rule_ca_ei_ee_pytd" model="hr.salary.rule">
            <field name="name">EI - Employee - Previous Year To Date Contribution (EI_EE_PYTD)</field>
            <field name="sequence" eval="140"/>
            <field name="code">EI_EE_PYTD</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('CPP_C',date_from,date_to)
            </field>
        </record>
        
        <record id="rule_ca_ei_ee_maxc" model="hr.salary.rule">
            <field name="name">EI - Employee - Maximum Insurable Earnings (EI_EE_MAXIE)</field>
            <field name="sequence" eval="141"/>
            <field name="code">EI_EE_MAXIE</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
benefits = contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, exemption='qpip_exempt', employer=True, pays_per_year=P)
result = min((benefits + GROSS)/P, 48600 - EI_EE_PYTD)
result = max(result, 0)
            </field>
        </record>
        
        <record id="rule_ca_ei_ee_m" model="hr.salary.rule">
            <field name="name">EI - Employee - Maximum Contribution (EI_EE_M)</field>
            <field name="sequence" eval="131"/>
            <field name="code">EI_EE_M</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">fix</field>
            <field name="quantity">1.0</field>
            <field name="amount_fix">913.68</field>
        </record>

        <record id="rule_ca_ei_ee_c" model="hr.salary.rule">
            <field name="name">EI - Employee Contribution (EI_EE_C)</field>
            <field name="sequence" eval="142"/>
            <field name="code">EI_EE_C</field>
            <field name="category_id" ref="SDED"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field> 
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = min(0.0188 * EI_EE_MAXIE, EI_EE_M)  
if employee.ei_exempt:
    result = 0
            </field>
        </record>
        
        <record id="rule_ca_ei_ee_ytd" model="hr.salary.rule">
            <field name="name">EI - Employee Year to Date Contribution (EI_EE_YTD)</field>
            <field name="sequence" eval="143"/>
            <field name="code">EI_EE_YTD</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field> 
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = EI_EE_PYTD + EI_EE_C
            </field>
        </record>
        
        <record id="rule_ca_ei_er_m" model="hr.salary.rule">
            <field name="name">EI - Employer - Maximum Contribution (EI_ER_M)</field>
            <field name="sequence" eval="131"/>
            <field name="code">EI_ER_M</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">fix</field>
            <field name="quantity">1.0</field>
            <field name="amount_fix">1278.2</field>
        </record>
        
        <record id="rule_ca_ei_er_c" model="hr.salary.rule">
            <field name="name">EI - Employer Contribution (EI_ER_C)</field>
            <field name="sequence" eval="144"/>
            <field name="code">EI_ER_C</field>
            <field name="category_id" ref="EMP"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field> 
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = min(EI_EE_C * 1.4, EI_ER_M)
            </field>
        </record>
        
        <record id="rule_ca_ei_er_ytd" model="hr.salary.rule">
            <field name="name">EI - Employer Contribution (EI_ER_YTD)</field>
            <field name="sequence" eval="145"/>
            <field name="code">EI_ER_YTD</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field> 
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('EI_ER_C',date_from,date_to) + EI_ER_C
            </field>
        </record>

    <!-- Canada Pension Plan - 130 -->

        <record id="rule_ca_cpp_s3" model="hr.salary.rule">
            <field name="name">CPP - Employee's gross pensionable salary under the CPP for the pay period (CPP_S3)</field>
            <field name="sequence" eval="130"/>
            <field name="code">CPP_S3</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = (contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, exemption='cpp_exempt', employer=True, pays_per_year=P) + GROSS)/P
            </field>
        </record>

        <record id="rule_ca_cpp_v" model="hr.salary.rule">
            <field name="name">CPP - Basic Exemption (CPP_V)</field>
            <field name="sequence" eval="130"/>
            <field name="code">CPP_V</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">fix</field>
            <field name="quantity">1.0</field>
            <field name="amount_fix">3500</field>
        </record>

    <!-- Canada Pension Plan - Employee - 131 -->

        <record id="rule_ca_cpp_m" model="hr.salary.rule">
            <field name="name">CPP - Employee - Maximum Contribution (CPP_M)</field>
            <field name="sequence" eval="131"/>
            <field name="code">CPP_M</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">fix</field>
            <field name="quantity">1.0</field>
            <field name="amount_fix">2425.50</field>
        </record>

        <record id="rule_ca_cpp_a5" model="hr.salary.rule">
            <field name="name">CPP - Employee - Previous Year To Date Contribution (CPP_A5)</field>
            <field name="sequence" eval="132"/>
            <field name="code">CPP_A5</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('CPP_C',date_from,date_to)
            </field>
        </record>

        <record id="rule_ca_cpp_c" model="hr.salary.rule">
            <field name="name">CPP - Employee Contribution (CPP_C)</field>
            <field name="sequence" eval="133"/>
            <field name="code">CPP_C</field>
            <field name="category_id" ref="SDED"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = min(0.0495 * (CPP_S3 - CPP_V/P), CPP_M - CPP_A5)
if employee.cpp_exempt:
    result = 0
result = max(result, 0)
            </field>
        </record>

        <record id="rule_ca_cpp_ee_ytd" model="hr.salary.rule">
            <field name="name">CPP - Employee - Year To Date Contribution (CPP_EE_YTD)</field>
            <field name="sequence" eval="134"/>
            <field name="code">CPP_EE_YTD</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field> 
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = CPP_C + CPP_A5</field>
        </record>

    <!-- Canada Pension Plan - Employer - 135 -->

        <record id="rule_ca_cpp_a5_er" model="hr.salary.rule">
            <field name="name">CPP - Employer - Previous Year To Date Contribution (CPP_A5_ER)</field>
            <field name="sequence" eval="135"/>
            <field name="code">CPP_A5_ER</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('CPP_C_ER',date_from,date_to)
            </field>
        </record>

        <record id="rule_ca_cpp_c_er" model="hr.salary.rule">
            <field name="name">CPP - Employer Contribution (CPP_C_ER)</field>
            <field name="sequence" eval="136"/>
            <field name="code">CPP_C_ER</field>
            <field name="category_id" ref="EMP"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = CPP_C
            </field>
        </record>

        <record id="rule_ca_cpp_er_ytd" model="hr.salary.rule">
            <field name="name">CPP - Employer - Year To Date Contribution (CPP_ER_YTD)</field>
            <field name="sequence" eval="137"/>
            <field name="code">CPP_ER_YTD</field>
            <field name="category_id" ref="PCALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field> 
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = CPP_C_ER + CPP_A5_ER</field>
        </record>


    <!-- Federal Income Tax - 170 -->

        <record id="rule_ca_fit_i" model="hr.salary.rule">
            <field name="name">FIT - Gross remuneration for the pay period (FIT_I)</field>
            <field name="sequence" eval="170"/>
            <field name="code">FIT_I</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = (contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, exemption='fit_exempt', employer=True, pays_per_year=P) + GROSS)/P
            </field>
        </record>
        
        <record id="rule_ca_fit_f" model="hr.salary.rule">
            <field name="name">FIT - Deduction for contributions to pension plans (FIT_F)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_F</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_F')
            </field>
        </record>
        
        <record id="rule_ca_fit_f2" model="hr.salary.rule">
            <field name="name">FIT - Deduction for alimony or maintenance payments (FIT_F2)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_F2</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_F2')
            </field>
        </record>
        
        <record id="rule_ca_fit_u1" model="hr.salary.rule">
            <field name="name">FIT - Deduction for union dues (FIT_U1)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_U1</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_U1')
            </field>
        </record>
        
        <record id="rule_ca_fit_hd" model="hr.salary.rule">
            <field name="name">FIT - Annual deduction for living in a prescribed zone (FIT_HD)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_HD</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_HD')
            </field>
        </record>
        
        <record id="rule_ca_fit_f1" model="hr.salary.rule">
            <field name="name">FIT - Annual deductions for child care and support payments (FIT_F1)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_F1</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_F1')
            </field>
        </record>
        
        <record id="rule_ca_fit_a" model="hr.salary.rule">
            <field name="name">FIT - Annual taxable income (FIT_A)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_A</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = P * (FIT_I - FIT_F - FIT_F2 - FIT_U1) - FIT_HD - FIT_F1
result = max(result, 0)
            </field>
        </record>
        
        <record id="rule_ca_fit_k1" model="hr.salary.rule">
            <field name="name">FIT - Federal personal tax credit (FIT_K1)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_K1</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_K1')
            </field>
        </record>
        
        <!-- Rule for the calculation of the federal CPP, QPIP and EI tax credit -->
        <record id="rule_ca_fit_k2" model="hr.salary.rule">
            <field name="name">FIT - Year to date amount contributed CPP, QPIP and EI (FIT_K2)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_K2</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
deductions = [
    {'C': CPP_C, 'PYTD': CPP_A5, 'YTD': CPP_EE_YTD, 'max': CPP_M},
    {'C': EI_EE_C, 'PYTD': EI_EE_PYTD, 'YTD': EI_EE_YTD, 'max': EI_EE_M}
]

result = 0

for d in deductions:
    if d['YTD'] &lt; d['max']:
        result += d['C']
    
    elif d['PYTD'] &gt;= d['max']:
        result += d['max']
    
    elif (d['C'] * P) &lt; d['max']:
        result += d['max']

    else:
        result += d['C']
        
result = result * 0.15
            </field>
        </record>

        <record id="rule_ca_fit_k3" model="hr.salary.rule">
            <field name="name">FIT - Other federal tax credits (FIT_K3)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_K3</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_K3')
            </field>
        </record>
        
        <record id="rule_ca_fit_k4" model="hr.salary.rule">
            <field name="name">FIT - Canada employment credit (FIT_K4)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_K4</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = min(FIT_A, 1127) * 0.15
            </field>
        </record>
        
        <record id="rule_ca_fit_lcf" model="hr.salary.rule">
            <field name="name">FIT - Annual Federal labour-sponsored funds tax credit (FIT_LCF)</field>
            <field name="sequence" eval="171"/>
            <field name="code">FIT_LCF</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = employee.sum_deductions(employee.id, payslip.date_from, payslip.date_to, deduction_code='FIT_LCF')
            </field>
        </record>
        
        <record id="rule_ca_fit_t3" model="hr.salary.rule">
            <field name="name">FIT - Annual basic federal tax (FIT_T3)</field>
            <field name="sequence" eval="172"/>
            <field name="code">FIT_T3</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
brackets = [
	{'min': 0, 'max': 43953, 'R': 0.15, 'K': 0},
	{'min': 43953, 'max': 87907, 'R': 0.22, 'K': 3077},
	{'min': 87907, 'max': 136270, 'R': 0.26, 'K': 6593},
	{'min': 136270, 'max': 10**15, 'R': 0.29, 'K': 10681}
]

for b in brackets:
	if b['min'] &lt; FIT_A &lt;= b['max']:
		result = FIT_A * b['R'] - b['K'] - FIT_K1 - FIT_K2 - FIT_K3 - FIT_K4

result = max(result, 0)
        	</field>
        </record>
        
        <!-- Rule for the calculation of the federal income tax for the period -->
         <record id="rule_ca_fit_t1" model="hr.salary.rule">
            <field name="name">FIT - Federal income tax (FIT_T1)</field>
            <field name="sequence" eval="173"/>
            <field name="code">FIT_T1</field>
            <field name="appears_on_payslip" eval="0"/>
            <field name="active" eval="1"/>
            <field name="category_id" ref="FCALC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = max(FIT_T3 - FIT_LCF, 0)
            </field>
        </record>

		
		<record id="rule_ca_fit_t" model="hr.salary.rule">
            <field name="name">FIT - Federal income tax for the period (FIT_T)</field>
            <field name="sequence" eval="174"/>
            <field name="code">FIT_T</field>
            <field name="category_id" ref="SDED"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = FIT_T1/P
if employee.fit_exempt:
	result = 0
            </field>
        </record>

        <record id="rule_ca_fit_ytd" model="hr.salary.rule">
            <field name="name">FIT - Federal income tax year to date (FIT_YTD)</field>
            <field name="sequence" eval="175"/>
            <field name="code">FIT_YTD</field>
            <field name="category_id" ref="FCALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('FIT_T',date_from,date_to) + FIT_T
            </field>
        </record>

        <!-- Vacation - 210 -->

        <record id="rule_ca_vac" model="hr.salary.rule">
            <field name="name">Vacation (VAC)</field>
            <field name="sequence" eval="210"/>
            <field name="code">VAC</field>
            <field name="category_id" ref="VAC"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, employer=True, pays_per_year=P) + GROSS
result = (result * contract.weeks_of_vacation * 0.02)/P
			</field>
        </record>

        <record id="rule_ca_vac_ytd" model="hr.salary.rule">
            <field name="name">Vacation - Year To Date (VAC_YTD)</field>
            <field name="sequence" eval="211"/>
            <field name="code">VAC_YTD</field>
            <field name="category_id" ref="VAC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('VAC',date_from,date_to) + VAC
            </field>
        </record>
        
            <!-- Insurance -  Employee - 150 -->

        <record id="rule_ca_ins_ee_c" model="hr.salary.rule">
            <field name="name">Insurance - Employee Contribution (INS_EE_C)</field>
            <field name="sequence" eval="150"/>
            <field name="code">INS_EE_C</field>
            <field name="category_id" ref="SDED"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, benefit_code='INS', annual=False, pays_per_year=P)
            </field>
        </record>

        <record id="rule_ca_ins_ee_ytd" model="hr.salary.rule">
            <field name="name">Insurance - Employee - Year To Date Contribution (INS_EE_YTD)</field>
            <field name="sequence" eval="151"/>
            <field name="code">INS_EE_YTD</field>
            <field name="category_id" ref="CALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('INS_EE_C',date_from,date_to) + INS_EE_C
        </field>
        </record>

    <!-- Insurance - Employer - 152 -->

        <record id="rule_ca_ins_er_c" model="hr.salary.rule">
            <field name="name">Insurance - Employer Contribution (INS_ER_C)</field>
            <field name="sequence" eval="152"/>
            <field name="code">INS_ER_C</field>
            <field name="category_id" ref="EMP"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, benefit_code='INS', annual=False, pays_per_year=P, employer=True)
            </field>
        </record>
        
        <record id="rule_ca_ins_er_ytd" model="hr.salary.rule">
            <field name="name">Insurance - Employee - Year To Date Contribution (INS_ER_YTD)</field>
            <field name="sequence" eval="153"/>
            <field name="code">INS_ER_YTD</field>
            <field name="category_id" ref="CALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('INS_ER_C',date_from,date_to) + INS_ER_C
        	</field>
        </record>
        
        <!-- Other Benefits -  Employee - 155 -->

        <record id="rule_ca_ben_ee_c" model="hr.salary.rule">
            <field name="name">Benefits except insurance - Employee Contribution (BEN_EE_C)</field>
            <field name="sequence" eval="155"/>
            <field name="code">BEN_EE_C</field>
            <field name="category_id" ref="SDED"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, annual=False, pays_per_year=P) - INS_EE_C
            </field>
        </record>

        <record id="rule_ca_ben_ee_ytd" model="hr.salary.rule">
            <field name="name">Employee Benefits except insurance - Employee Year To Date Contribution (BEN_EE_YTD)</field>
            <field name="sequence" eval="156"/>
            <field name="code">BEN_EE_YTD</field>
            <field name="category_id" ref="CALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('BEN_EE_C',date_from,date_to) + BEN_EE_C
        	</field>
        </record>

    <!-- Other benefits - Employer - 157 -->

        <record id="rule_ca_ben_er_c" model="hr.salary.rule">
            <field name="name">Employee Benefits except insurance - Employer Contribution (BEN_ER_C)</field>
            <field name="sequence" eval="157"/>
            <field name="code">BEN_ER_C</field>
            <field name="category_id" ref="EMP"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = contract.sum_benefits(contract.id, payslip.date_from, payslip.date_to, annual=False, pays_per_year=P, employer=True) - INS_ER_C
            </field>
        </record>
        
        <record id="rule_ca_ben_er_ytd" model="hr.salary.rule">
            <field name="name">Employee Benefits except insurance - Employee Year To Date Contribution (BEN_ER_YTD)</field>
            <field name="sequence" eval="158"/>
            <field name="code">BEN_ER_YTD</field>
            <field name="category_id" ref="CALC"/>
            <field name="appears_on_payslip" eval="1"/>
            <field name="active" eval="1"/>
            <field name="condition_select">none</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">date_from = payslip.date_to.split('-')[0] + '-01-01'
date_to = payslip.date_to
result = payslip.sum('BEN_ER_C',date_from,date_to) + BEN_ER_C
        	</field>
        </record>
        
        
    <!-- Update salary rules of hr_payroll -->

        <record id="hr_payroll.hr_rule_basic" model="hr.salary.rule">
            <field name="appears_on_payslip" eval="0"/>
        </record>

        <record id="hr_payroll.hr_rule_taxable" model="hr.salary.rule">
            <field name="appears_on_payslip" eval="0"/>
        </record>
        
        <record id="hr_payroll.hr_rule_net" model="hr.salary.rule">
            <field name="amount_python_compute">result = BASICP + BEN_ER_C + INS_ER_C - categories.DED - categories.SDED</field>
        </record>

    </data>
</openerp>
